#! /bin/sh

. "${srcdir=.}/init.sh"; path_prepend_ $exedir

fail=0
test_name="match"

# basic literal string matches
input="Hello, world"
pattern="Hello"
expected="Hello, world"
match_test "$input" "$pattern" "$expected" "${test_name} 1"

# basic literal string multiline matches
input="Hello,\n world"
pattern="Hello"
expected="Hello,"
match_test "$input" "$pattern" "$expected" "${test_name} 2"

# any character
input="Hello, world"
pattern="."
expected="Hello, world"
match_test "$input" "$pattern" "$expected" "${test_name} 3"

input="Hello,\n1234\n?!"
pattern="."
expected="Hello,\n1234\n?!"
match_test "$input" "$pattern" "$expected" "${test_name} 4"

# '\' followed by any char except a digit, '(', or ')' matches that char
input="Hello,\n1234\n?!"
pattern="\H"
expected="Hello,"
match_test "$input" "$pattern" "$expected" "${test_name} 5"

input="Hello,\n1234\n?!"
pattern="\,"
expected="Hello,"
match_test "$input" "$pattern" "$expected" "${test_name} 6"

input="Hello,\n1234\n?!"
pattern="\?"
expected="?!"
match_test "$input" "$pattern" "$expected" "${test_name} 7"

# anchor matches
input="Hello, world"
pattern="^world"
expected=""
match_test "$input" "$pattern" "$expected" "${test_name} 3"

exit $fail